
.page-header
  %h1 Welcome To Chaskiq

.row.row-cards

  .card
    .card-header
      %h3.card-title
        You have #{@campaigns_count} campaigns and #{@sends_count} sended messages.
        
    .card-body.row

      .col-sm-3
        = pie_chart @pie_metrics.count, height: "220px", legend: "bottom", donut: true

      .col-sm-9
        %h4.text-center Last 2 weeks
        .flot-chart.dashboard-chart.m-t-lg
          = column_chart( @chart_data, height: "220px", width: "100%",  format: "%l %P")
          -##flot-dashboard-chart.flot-chart-content

  .card
    .card-header
      %h3.card-title Latests Campaigns

    .card-body

      .table-responsive
        
        %table.table.card-table.table-vcenter.text-nowrap
          %thead
            %tr
              %th Campaign
              %th Last 2 weeks
              %th Deliveries
              %th Actions
          %tbody

            - @campaigns.each do |c|
              %tr
                %td
                  %div
                    = link_to c.name.upcase, manage_campaign_path(c)
                    .small.text-muted
                      = c.created_at

                %td
                  %span.bar_dashboard.pull-right
                    = c.sparklines_by_day().join(", ")

                %td
                  %small.m-r
                    %i.fa.fa-paper-plane
                      = c.metrics.deliveries.size
                      deliveries

                %td.text-center
                  = render "chaskiq/manage/campaigns/config_actions", campaign: c


- content_for :javascript do
  :javascript

    $(".bar_dashboard").peity("bar", {
        fill: ["#1ab394", "#d7d7d7"],
        width: 100
    })

    $("#sparkline8").sparkline(#{@daily_metrics.map{|o|o.to_a.last}.to_json}, {
        type: 'bar',
        barWidth: 8,
        height: '150px',
        barColor: '#1ab394',
        negBarColor: '#c6c6c6'
    });

    $("#flot-dashboard-chart").length && $.plot($("#flot-dashboard-chart"), [
        data1, data2
    ],
            {
                series: {
                    lines: {
                        show: false,
                        fill: true
                    },
                    splines: {
                        show: true,
                        tension: 0.4,
                        lineWidth: 1,
                        fill: 0.4
                    },
                    points: {
                        radius: 0,
                        show: true
                    },
                    shadowSize: 2
                },
                grid: {
                    hoverable: true,
                    clickable: true,
                    tickColor: "#d5d5d5",
                    borderWidth: 1,
                    color: '#d5d5d5'
                },
                colors: ["#1ab394", "#464f88"],
                xaxis: {
                },
                yaxis: {
                    ticks: 4
                },
                tooltip: false
            }
    );


